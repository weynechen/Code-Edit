#include "stdio.h"
#include "rec.h"
#include "pro.h"
#include "transmit.h"

u8 DataIn[] = {0x00,0x00,0xD8,0x09,0x00,0x00,0x00,0x0A,0x00,0x00,0x14,0x00,0x00,0x1E,0x00,0x00,0x28,0x00,0x00,0x32,0x00,0x00,0x3C,0x00,0x00,0x46,0x00,0x00,0x50,0x00,0x00,0x5A,0x00,0x00,0x64,0x00,0x00,0x6E,0x00,0x00,0x78,0x00,0x00,0x82,0x00,0x00,0x8C,0x00,0x00,0x96,0x00,0x00,0xA0,0x00,0x00,0xA5,0xAA,0x00,0x00,0xB4,0x00,0x00,0xBE,0x00,0x00,0xC8,0x00,0x00,0xD2,0x00,0x00,0xDC,0x00,0x00,0xE6,0x00,0x00,0xF0,0x00,0x00,0xFA,0x00,0x00,0x04,0x01,0x00,0x0E,0x01,0x00,0x18,0x01,0x00,0x22,0x01,0x00,0x2C,0x01,0x00,0x36,0x01,0x00,0x40,0x01,0x00,0x4A,0x01,0x00,0x54,0x01,0x00,0x5E,0x01,0x00,0x68,0x01,0x00,0x72,0x01,0x00,0x7C,0x01,0x00,0x86,0x01,0x00,0x90,0x01,0x00,0x9A,0x01,0x00,0xA4,0x01,0x00,0xAE,0x01,0x00,0xB8,0x01,0x00,0xC2,0x01,0x00,0xCC,0x01,0x00,0xD6,0x01,0x00,0xE0,0x01,0x00,0xEA,0x01,0x00,0xF4,0x01,0x00,0xFE,0x01,0x00,0x08,0x02,0x00,0x12,0x02,0x00,0x1C,0x02,0x00,0x26,0x02,0x00,0x30,0x02,0x00,0x3A,0x02,0x00,0x44,0x02,0x00,0x4E,0x02,0x00,0x58,0x02,0x00,0x62,0x02,0x00,0x6C,0x02,0x00,0x76,0x02,0x00,0x80,0x02,0x00,0x8A,0x02,0x00,0x94,0x02,0x00,0x9E,0x02,0x00,0xA8,0x02,0x00,0xB2,0x02,0x00,0xBC,0x02,0x00,0xC6,0x02,0x00,0xD0,0x02,0x00,0xDA,0x02,0x00,0xE4,0x02,0x00,0xEE,0x02,0x00,0xF8,0x02,0x00,0x02,0x03,0x00,0x0C,0x03,0x00,0x16,0x03,0x00,0x20,0x03,0x00,0x2A,0x03,0x00,0x34,0x03,0x00,0x3E,0x03,0x00,0x48,0x03,0x00,0x52,0x03,0x00,0x5C,0x03,0x00,0x66,0x03,0x00,0x70,0x03,0x00,0x7A,0x03,0x00,0x84,0x03,0x00,0x8E,0x03,0x00,0x98,0x03,0x00,0xA2,0x03,0x00,0xAC,0x03,0x00,0xB6,0x03,0x00,0xC0,0x03,0x00,0xCA,0x03,0x00,0xD4,0x03,0x00,0xDE,0x03,0x00,0xE8,0x03,0x00,0xF2,0x03,0x00,0xFC,0x03,0x00,0x06,0x04,0x00,0x10,0x04,0x00,0x1A,0x04,0x00,0x24,0x04,0x00,0x2E,0x04,0x00,0x38,0x04,0x00,0x42,0x04,0x00,0x4C,0x04,0x00,0x56,0x04,0x00,0x60,0x04,0x00,0x6A,0x04,0x00,0x74,0x04,0x00,0x7E,0x04,0x00,0x88,0x04,0x00,0x92,0x04,0x00,0x9C,0x04,0x00,0xA6,0x04,0x00,0xB0,0x04,0x00,0xBA,0x04,0x00,0xC4,0x04,0x00,0xCE,0x04,0x00,0xD8,0x04,0x00,0xE2,0x04,0x00,0xEC,0x04,0x00,0xF6,0x04,0x00,0x00,0x05,0x00,0x0A,0x05,0x00,0x14,0x05,0x00,0x1E,0x05,0x00,0x28,0x05,0x00,0x32,0x05,0x00,0x3C,0x05,0x00,0x46,0x05,0x00,0x50,0x05,0x00,0x5A,0x05,0x00,0x64,0x05,0x00,0x6E,0x05,0x00,0x78,0x05,0x00,0x82,0x05,0x00,0x8C,0x05,0x00,0x96,0x05,0x00,0xA0,0x05,0x00,0xA5,0xAA,0x05,0x00,0xB4,0x05,0x00,0xBE,0x05,0x00,0xC8,0x05,0x00,0xD2,0x05,0x00,0xDC,0x05,0x00,0xE6,0x05,0x00,0xF0,0x05,0x00,0xFA,0x05,0x00,0x04,0x06,0x00,0x0E,0x06,0x00,0x18,0x06,0x00,0x22,0x06,0x00,0x2C,0x06,0x00,0x36,0x06,0x00,0x40,0x06,0x00,0x4A,0x06,0x00,0x54,0x06,0x00,0x5E,0x06,0x00,0x68,0x06,0x00,0x72,0x06,0x00,0x7C,0x06,0x00,0x86,0x06,0x00,0x90,0x06,0x00,0x9A,0x06,0x00,0xA4,0x06,0x00,0xAE,0x06,0x00,0xB8,0x06,0x00,0xC2,0x06,0x00,0xCC,0x06,0x00,0xD6,0x06,0x00,0xE0,0x06,0x00,0xEA,0x06,0x00,0xF4,0x06,0x00,0xFE,0x06,0x00,0x08,0x07,0x00,0x12,0x07,0x00,0x1C,0x07,0x00,0x26,0x07,0x00,0x30,0x07,0x00,0x3A,0x07,0x00,0x44,0x07,0x00,0x4E,0x07,0x00,0x58,0x07,0x00,0x62,0x07,0x00,0x6C,0x07,0x00,0x76,0x07,0x00,0x80,0x07,0x00,0x8A,0x07,0x00,0x94,0x07,0x00,0x9E,0x07,0x00,0xA8,0x07,0x00,0xB2,0x07,0x00,0xBC,0x07,0x00,0xC6,0x07,0x00,0xD0,0x07,0x00,0xDA,0x07,0x00,0xE4,0x07,0x00,0xEE,0x07,0x00,0xF8,0x07,0x00,0x02,0x08,0x00,0x0C,0x08,0x00,0x16,0x08,0x00,0x20,0x08,0x00,0x2A,0x08,0x00,0x34,0x08,0x00,0x3E,0x08,0x00,0x48,0x08,0x00,0x52,0x08,0x00,0x5C,0x08,0x00,0x66,0x08,0x00,0x70,0x08,0x00,0x7A,0x08,0x00,0x84,0x08,0x00,0x8E,0x08,0x00,0x98,0x08,0x00,0xA2,0x08,0x00,0xAC,0x08,0x00,0xB6,0x08,0x00,0xC0,0x08,0x00,0xCA,0x08,0x00,0xD4,0x08,0x00,0xDE,0x08,0x00,0xE8,0x08,0x00,0xF2,0x08,0x00,0xFC,0x08,0x00,0x06,0x09,0x00,0x10,0x09,0x00,0x1A,0x09,0x00,0x24,0x09,0x00,0x2E,0x09,0x00,0x38,0x09,0x00,0x42,0x09,0x00,0x4C,0x09,0x00,0x56,0x09,0x00,0x60,0x09,0x00,0x6A,0x09,0x00,0x74,0x09,0x00,0x7E,0x09,0x00,0x88,0x09,0x00,0x92,0x09,0x00,0x9C,0x09,0x00,0xA6,0x09,0x00,0xB0,0x09,0x00,0xBA,0x09,0x00,0xC4,0x09,0x00,0xCE,0x09,0x00,0xD8,0x09,0x00,0xE2,0x09,0x00,0xEC,0x09,0x00,0xF6,0x09,0x00,0x00,0x0A,0x00,0x0A,0x0A,0x00,0x14,0x0A,0x00,0x1E,0x0A,0x00,0x28,0x0A,0x00,0x32,0x0A,0x00,0x3C,0x0A,0x00,0x46,0x0A,0x00,0x50,0x0A,0x00,0x5A,0x0A,0x00,0x64,0x0A,0x00,0x6E,0x0A,0x00,0x78,0x0A,0x00,0x82,0x0A,0x00,0x8C,0x0A,0x00,0x96,0x0A,0x00,0xA0,0x0A,0x00,0xA5,0xAA,0x0A,0x00,0xB4,0x0A,0x00,0xBE,0x0A,0x00,0xC8,0x0A,0x00,0xD2,0x0A,0x00,0xDC,0x0A,0x00,0xE6,0x0A,0x00,0xF0,0x0A,0x00,0xFA,0x0A,0x00,0x04,0x0B,0x00,0x0E,0x0B,0x00,0x18,0x0B,0x00,0x22,0x0B,0x00,0x2C,0x0B,0x00,0x36,0x0B,0x00,0x40,0x0B,0x00,0x4A,0x0B,0x00,0x54,0x0B,0x00,0x5E,0x0B,0x00,0x68,0x0B,0x00,0x72,0x0B,0x00,0x7C,0x0B,0x00,0x86,0x0B,0x00,0x90,0x0B,0x00,0x9A,0x0B,0x00,0xA4,0x0B,0x00,0xAE,0x0B,0x00,0xB8,0x0B,0x00,0xC2,0x0B,0x00,0xCC,0x0B,0x00,0xD6,0x0B,0x00,0xE0,0x0B,0x00,0xEA,0x0B,0x00,0xF4,0x0B,0x00,0xFE,0x0B,0x00,0x08,0x0C,0x00,0x12,0x0C,0x00,0x1C,0x0C,0x00,0x26,0x0C,0x00,0x30,0x0C,0x00,0x3A,0x0C,0x00,0x44,0x0C,0x00,0x4E,0x0C,0x00,0x58,0x0C,0x00,0x62,0x0C,0x00,0x6C,0x0C,0x00,0x76,0x0C,0x00,0x80,0x0C,0x00,0x8A,0x0C,0x00,0x94,0x0C,0x00,0x9E,0x0C,0x00,0xA8,0x0C,0x00,0xB2,0x0C,0x00,0xBC,0x0C,0x00,0xC6,0x0C,0x00,0xD0,0x0C,0x00,0xDA,0x0C,0x00,0xE4,0x0C,0x00,0xEE,0x0C,0x00,0xF8,0x0C,0x00,0x02,0x0D,0x00,0x0C,0x0D,0x00,0x16,0x0D,0x00,0x20,0x0D,0x00,0x2A,0x0D,0x00,0x34,0x0D,0x00,0x3E,0x0D,0x00,0x48,0x0D,0x00,0x52,0x0D,0x00,0x5C,0x0D,0x00,0x66,0x0D,0x00,0x70,0x0D,0x00,0x7A,0x0D,0x00,0x84,0x0D,0x00,0x8E,0x0D,0x00,0x98,0x0D,0x00,0xA2,0x0D,0x00,0xAC,0x0D,0x00,0xB6,0x0D,0x00,0xC0,0x0D,0x00,0xCA,0x0D,0x00,0xD4,0x0D,0x00,0xDE,0x0D,0x00,0xE8,0x0D,0x00,0xF2,0x0D,0x00,0xFC,0x0D,0x00,0x06,0x0E,0x00};
u8 DataOut[2048];
u8 DataAdd[2048];
u8 DataAfterParse[2048];

int main(int argc,char *args[])
{
    u32 len = 0 ;
    u32 out_len = 0;
    int i =0;
    PackageDataStruct package;

    printf("protocol test\n");
    printf("input data:");
    for(i =0;i<sizeof(DataIn);i++)
    {
        printf("%02x ",DataIn[i]);
    }

    package.DataID = PACK_LIDAR_DATA;
    package.DataInLen = sizeof(DataIn);
    package.DataOutBuff = DataOut;
    package.DataInBuff = DataIn;
    package.DataOutLen = &len;
    Package(package);

    printf("\npacking:\n");
    for(i = 0 ;i<len;i++)
    {
        printf("%02x ",DataOut[i]);
    }

    package.DataInBuff = DataOut;
    package.DataInLen = len;
    package.DataOutLen = &out_len; 
    Unpacking(&package);

    printf("\nunpackage:\n");
    printf("package id: %d\n",package.DataID);
    printf("data len : %d\n",out_len);
    printf("unpackage data:");
    for(i =0;i<out_len;i++)
    {
        printf("%02x ",package.DataOutBuff[i]);
    }
    printf("\ntest end\n");
    getchar();
}